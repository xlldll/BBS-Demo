/*! BBS_Demo_Github-0.0.1.js 2017-04-04 20:52 */
$(function(){$(".form_date").datetimepicker({language:"zh-CN",weekStart:1,todayBtn:1,autoclose:1,todayHighlight:1,startView:2,minView:2,forceParse:0}),$('[data-toggle="tooltip"]').tooltip({placement:"top"}),$.cookie("user")?($("#member, #logout").show(),$("#reg, #log").hide(),$("#member").html($.cookie("user"))):($("#member, #logout").hide(),$("#reg, #log").show()),$("#reg").click(function(){$("#regBox").modal({show:!0,keyboard:!0}),$("#regForm").resetForm()}),$("#log").click(function(){$("#logBox").modal({show:!0,keyboard:!0}),$("#logForm").resetForm()}),$("#logout").click(function(){$.removeCookie("user"),window.location.href=window.location.href}),$("#returnLog").click(function(){$(this).parents(".modal-footer").prev(".modal-body").find("input").removeClass("invalid valid"),$("#logWarn").children().css("display","none")}),$("#returnReg").click(function(){$(this).parents(".modal-footer").prev(".modal-body").find("input").removeClass("invalid valid"),$("#regWarn").children().css("display","none")}),$("#regForm").validate({rules:{userN:{required:!0,minlength:6,remote:{url:"http://bbs-demo/src/php/is_user.php",type:"POST"}},pw:{required:!0,minlength:6},email:{required:!0,email:!0}},messages:{userN:{required:"帐号不得为空！",minlength:jQuery.format("帐号不得小于{0}位！"),remote:"帐号被占用！"},pw:{required:"密码不得为空！",minlength:jQuery.format("密码不得小于{0}位！")},email:{required:"邮箱不得为空！",minlength:"请输入正确的邮箱地址！"}},errorLabelContainer:"#regWarn",wrapper:"span",submitHandler:function(a){$(a).ajaxSubmit({url:"http://bbs-demo/src/php/add.php",type:"POST",beforeSubmit:function(a,b,c){$("#regDiv").popover({html:!0,content:'正在为您注册&nbsp;<img src="img/loading.gif"/>',placement:"top",delay:{show:50,hide:50},trigger:"manual"}),$("#regDiv").popover("show"),$("#regBtn").attr("disabled","")},success:function(a,b){a&&($("#regDiv").popover({html:!0,content:'已经注册成功&nbsp;<img src="img/success.gif"/>',placement:"top",delay:{show:50,hide:50},trigger:"manual"}),$.cookie("user",$("#account").val()),setTimeout(function(){$("#regBox").modal("hide"),$("#regForm").resetForm(),$("#regBtn").removeAttr("disabled",""),$("#regDiv").popover("hide"),$("#member, #logout").show(),$("#reg, #log").hide(),$("#member").html($.cookie("user"))},2e3))}})},highlight:function(a,b){$(a).removeClass("valid"),$(a).addClass("invalid")},unhighlight:function(a,b){$(a).removeClass("invalid"),$(a).addClass("valid")}}),$("#logForm").validate({rules:{logAccount:{required:!0,minlength:5},logPassword:{required:!0,minlength:6}},messages:{logAccount:{required:"帐号不得为空！",minlength:jQuery.format("帐号不得小于{0}位！")},logPassword:{required:"密码不得为空！",minlength:jQuery.format("密码不得小于{0}位！")}},errorLabelContainer:"#logWarn",wrapper:"span",submitHandler:function(a){$(a).ajaxSubmit({url:"http://bbs-demo/src/php/login.php",type:"POST",beforeSubmit:function(a,b,c){$("#logDiv").popover({html:!0,content:'正在为您登录&nbsp;<img src="img/loading.gif"/>',placement:"top",delay:{show:50,hide:50},trigger:"manual"}),$("#logDiv").popover("show"),$("#logBtn").attr("disabled","")},success:function(a,b){a&&($("#logDiv").popover({html:!0,content:'已经登录成功&nbsp;<img src="img/success.gif"/>',placement:"top",delay:{show:50,hide:50},trigger:"manual"}),$("#logExp").is(":checked")?$.cookie("user",$("#logAccount").val(),{expires:7}):$.cookie("user",$("#logAccount").val()),setTimeout(function(){$("#logDiv").popover("hide"),$("#logBtn").removeAttr("disabled",""),$("#logBox").modal("hide"),$("#logForm").resetForm(),$("#member, #logout").show(),$("#reg, #log").hide(),$("#member").html($.cookie("user"))},2e3))}})},highlight:function(a,b){$(a).removeClass("valid"),$(a).addClass("invalid")},unhighlight:function(a,b){$(a).removeClass("invalid"),$(a).addClass("valid")}})});